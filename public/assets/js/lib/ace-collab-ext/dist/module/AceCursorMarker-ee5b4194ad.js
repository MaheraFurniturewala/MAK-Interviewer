export class AceCursorMarker{constructor(t,e,i,s,o){this._session=t,this._label=i,this._color=s,this._position=o?this._convertPosition(o):null,this._cursorId=e,this._id=null,this._visible=!1,this._tooltipTimeout=null,this._markerElement=document.createElement("div"),this._cursorElement=document.createElement("div"),this._cursorElement.className="ace-multi-cursor",this._cursorElement.style.background=this._color,this._markerElement.append(this._cursorElement),this._tooltipElement=document.createElement("div"),this._tooltipElement.className="ace-multi-cursor-tooltip",this._tooltipElement.style.background=this._color,this._tooltipElement.style.opacity="0",this._tooltipElement.innerHTML=i,this._markerElement.append(this._tooltipElement)}update(t,e,i,s){if(null===this._position)return;const o=this._session.documentToScreenPosition(this._position.row,this._position.column),l=e.$getTop(o.row,s),n=e.$padding+o.column*s.characterWidth,r=s.lineHeight,h=l+2,_=r-3,m=n;this._cursorElement.style.height=`${_}px`,this._cursorElement.style.width="2px",this._cursorElement.style.top=`${h}px`,this._cursorElement.style.left=`${m}px`;let c=h-r;c<5&&(c=h+r-1);const u=m;this._tooltipElement.style.top=c-2+"px",this._tooltipElement.style.left=u-2+"px",this._markerElement.remove(),e.elt("remote-cursor","");(e.element.childNodes[e.i-1]||e.element.lastChild).appendChild(this._markerElement)}setPosition(t){this._position=this._convertPosition(t),this._forceSessionUpdate(),this._tooltipElement.style.opacity="1",this._scheduleTooltipHide()}setVisible(t){const e=this._visible;this._visible=t,e!==this._visible&&(this._markerElement.style.visibility=t?"visible":"hidden",this._forceSessionUpdate())}isVisible(){return this._visible}cursorId(){return this._cursorId}markerId(){return this._id}getLabel(){return this._label}_forceSessionUpdate(){this._session._signal("changeFrontMarker")}_convertPosition(t){if(null===t)return null;if("number"==typeof t)return this._session.getDocument().indexToPosition(t,0);if("number"==typeof t.row&&"number"==typeof t.column)return t;throw new Error(`Invalid position: ${t}`)}_scheduleTooltipHide(){null!==this._tooltipTimeout&&clearTimeout(this._tooltipTimeout),this._tooltipTimeout=setTimeout((()=>{this._tooltipElement.style.opacity="0",this._tooltipTimeout=null}),2e3)}}